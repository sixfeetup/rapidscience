{% extends 'base.html' %}
{% load inplace_edit mytags core_tags %}

{% block page_title %}
    {% if query %}{{ query }}{% else %}CRDB{% endif %}
{% endblock page_title %}
{% block canonical %}
        <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
        <link rel="stylesheet" href="{{STATIC_URL}}css/jquery-ui.css" />
        <link href='https://fonts.googleapis.com/css?family=News+Cycle' rel='stylesheet' type='text/css'>
        
        {{ block.super }}
        <link rel="stylesheet" href="{{STATIC_URL}}css/cases.css">
{% endblock canonical %}
{% block js-footer %}
    {{ block.super }}
        {% inplace_static %}
        <script src="{{STATIC_URL}}js/bootstrap.min.js"></script>
        <script src="{{STATIC_URL}}js/jquery-ui.min.js"></script>
        <script src="{{STATIC_URL}}js/search.js"></script>
        <script src="{{STATIC_URL}}js/manual_form.js" ></script>
{% endblock js-footer %}

{% block content %}
        <div class="container">
            {% block container %}
                <div class="row cases-central-header">

                    <div class=" col-md-9 main-content ">
                       <div class="search-div">

                           <h1>Cases Central <a href="{% url 'crdb:add_casereport' %}" class="btn btn-primary"><span class="enbiggen">+</span> Add Case</a></h1>


                                <form method="get" action=".">


                                    <div class="input-group">
                                      <input type="text" class="form-control search" placeholder="Authors, institutions, drugs..."  onfocus="this.placeholder = ''" onblur="this.placeholder = 'Authors, institutions, drugs...'"  name="q" id="" value="{% if query %}{{ query }}{% else %}{% endif %}" >
                                 <span class="input-group-btn">
                                   <button type="submit" class="btn btn-primary search-button" type="button"><i class="fa fa-search"></i></button>
                                 </span>
                               </div><!-- /input-group -->
                             </div><!-- /.col-lg-12 -->



                                   </form>
                       </div>
                </div>

            <div class="search-page-tab-content row">
                <div id="search" class="tab-pane fade in active">
                        <div class="row">

                            <div class="result_block col-md-8">
                                {% include 'casereport/search/results.html' %}
                            </div>


                          <div class="col-md-4 filter-section">
                             <h2>Filter Cases</h2>
                            <div class="row">
                                <div class="col-sm-6">
                                     <div class="category-section">
                                         <h5>Categories</h5>
                                         <div class="checkbox">
                                             <label for="category1">
                                                <input class="filter-checkbox" type="checkbox" id="category1" value="0" name="category"  />
                                                Cases shared with me
                                             </label>
                                         </div>
                                         <div class="checkbox">
                                             <label for="category2">
                                                <input class="filter-checkbox" type="checkbox" id="category2" value="1" name="category"  />
                                                My cases
                                             </label>
                                         </div>
                                         <div class="checkbox">
                                             <label for="category3">
                                                <input class="filter-checkbox" type="checkbox" id="category3" value="2" name="category"  />
                                                My draft cases
                                             </label>
                                         </div>
                                     </div>
                                </div>
                                <div class="col-sm-6">
                                   <div class="gender-section">
                                        <h5>Gender</h5>
                                        {% for status in facets.fields.gender %}
                                            <div class="checkbox">
                                                <label class="checkbox-inline">
                                                    <input type="checkbox" class="filter-checkbox" value="{{ status.0|urlencode }}"
                                                       name="gender" data-url="selected_facets=gender_exact:{{ status.0|urlencode }}"
                                                       {% check_value_is_active "gender" status.0|urlencode request.get_full_path %} />
                                                    {{ status.0 }} ({{ status.1 }})
                                                </label>
                                            </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>

                        <p>
                          <label class="age" for="amount">Age range</label>
                          <input type="hidden" id="amount" value="{% age_range request.get_full_path facets.fields.age %}">
                        </p>
                         <div id="slider-range">
                             <div id="custom-min-handle" class="ui-slider-handle"></div>
                             <div id="custom-max-handle" class="ui-slider-handle"></div>
                         </div>

                                    </br>
                                    <div class="country-section">
                                        <h5>Country</h5>
                                        <select class="form-control select2" name="country">
                                            <option value="" ></option>
                                            {% for cnt in facets.fields.country %}
                                                {% if cnt.1 > 0 %}
                                                    <option value="selected_facets=country_exact:{{ cnt.0|urlencode }}" {% check_value_is_active "country" cnt.0 request.get_full_path %}>{{ cnt.0|title }} ({{ cnt.1 }})</option>
                                                {% endif %}
                                            {% endfor %}
                                        </select>
                                    </div>

                                  </br>

                                    <div class="treatment_type-section">
                                        <h5>Treatment Type</h5>
                                        <select class="form-control select2"  name="treatment_type">
                                         <option value="" ></option>

                                        <option value="selected_facets=treatment_type_exact:Chemotherapy" {% check_value_is_active "treatment_type" "Chemotherapy" request.get_full_path %}> Chemotherapy</option>
                                         <option value="selected_facets=treatment_type_exact:Immunotherapy" {% check_value_is_active "treatment_type" "Immunotherapy" request.get_full_path %}> Immunotherapy</option>
                                        <option value="selected_facets=treatment_type_exact:Radiotherapy" {% check_value_is_active "treatment_type" "Radiotherapy" request.get_full_path %}>Radiotherapy</option>
                                        <option value="selected_facets=treatment_type_exact:Surgery" {% check_value_is_active "treatment_type" "Surgery" request.get_full_path %}> Surgery</option>
                                        <option value="selected_facets=treatment_type_exact:Targeted Therapy" {% check_value_is_active "treatment_type" "Targeted Therapy" request.get_full_path %}>Targeted Therapy</option>


                                        </select>
                                    </div>


                                </div>


        </div>

      </div>
       {% endblock %}
        </div>
    <div class="overlay hide"></div>
{% endblock content %}
