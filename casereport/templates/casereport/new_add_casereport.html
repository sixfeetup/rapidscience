{% extends "casereport/search/search.html" %}
{% load static %}

{% block css %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'djangocms_text_ckeditor/css/cms.ckeditor.css' %}">
{% endblock  %}

{% block js-footer %}
    {{ block.super }}
    <script src="{{STATIC_URL}}js/add_case_report.js"></script>
    <script src="{% static "djangocms_text_ckeditor/ckeditor/ckeditor.js" %}"></script>
    <script src="{% static "cms/js/modules/cms.base.js" %}"></script>
    <script src="{% static 'djangocms_text_ckeditor/js/cms.ckeditor.js' %}"></script>
{% endblock js-footer %}

{% block content %}
  <div id="crdb-overlay-loader" class="active">
    <div id="crdb-thinking">
        <div class="crdb-spinner" role="spinner"><div class="crdb-spinner-icon"></div></div>
        <span class="crdb-loader-text">Submitting Case Report ...</span>
    </div>
</div>
<div class="main-wrapper">


  <div class="container">
      <div class="inside-wrapper">
      <div class="form submit-form">

    		<form id="caseform" name="caseform" class="rpds-form" action="{% url 'add_casereport' %}" method="post"
                  enctype="multipart/form-data">
                {% csrf_token %}
                
                <h4><label for="casetitle">Case Title</label></h4>
                <input name="casetitle" value="" type="text" class="form-control" id="casetitle">

                <h4 class="title-name">Primary Author/Contact</h4>
                <p class="user-meta"><strong>{{ request.user.get_full_name }}
                   {% if request.user.title %}, {{ request.user.title }}{% endif %}
                   {% if request.user.institution %}
                        | {{ request.user.institution }}{% if request.user.institution.city %},
                        {{ request.user.institution.city }}{% endif %}{% if request.user.institution.state %},
                        {{ request.user.institution.state }}{% endif %}
                        {% if request.user.institution.country %}| {{ request.user.institution.country }}{% endif %}
                   {% endif %}</strong>
                <br />{{ request.user.email }}</p>
                <div class="alert alert-danger required-message" role="alert">
                    <p>Please fill the fields marked with asterisk. (*)</p>
                </div>
                <div>
                    <label for="author">Alternative Correspondence Email Address</label>
                    <input name="author" value="{{ email }}"  type="EMAIL" class="form-control" id="author">
              </div>
              
              <h4>Co-Authors</h4>
              <div class="physician-div">
              </div>

              <a class="add_phy_button" href="#"><i class="fa fa-plus"></i> <span class="add_phy_button_text">Add co-author</a></a>

        <div class="form-group radio-box">
        <input {% if formtype == "M" %}checked="checked"{% endif %}  id="id_radio1" type="radio"  class="radiobut" name="entry-type" value="M" />
        <label for="id_radio1">Use Template</label>
        <input {% if formtype == "T" %}checked="checked"{% endif %} id="id_radio2" type="radio" class="radiobut"  name="entry-type" value="T" />
        <label for="id_radio2">Free Text</label>
        <input {% if formtype == "F" %}checked="checked"{% endif %} id="id_radio3" type="radio" class="radiobut"  name="entry-type" value="F" />
        <label for="id_radio3">Upload File</label>
            <div class="choose-message">
                <p>Choose one of the options.</p>
            </div>
        </div>

                <div id="pleasewait" class="progress-indicator">
                 <img src="{{ static_url }}/static/images/giphy.gif">
{#                        <p>Loading...</p>#}
                </div>
                <div id="myform">
                    <!-- 
                         section filled via JS
                         manualform.html, free-text.html, or fileform.html
                    -->
                </div>
                
                <!-- <div id="captcha">
                    {{ captchaform }}
                    <span id="invalid_cap" class="hide">Captcha Invalid</span>
                    <button class='js-captcha-refresh btn btn-primary '>refresh</button>
                    <div class="captcha-message">
                     <p>Captcha is required.</p>
                    </div>
                </div>
                <br> -->
                <div>
                    <input class="agree-checkbox" type="checkbox" id="agreement">
                    <label for="agreement">By checking this box, you confirm that you have obtained signed, written consent from the patient or,
                    if the patient is deceased, the patientâ€™s authorized relative to post this report.</label>
                    <div class="agree-message">
                     <p>Please select the checkbox.</p>
                    </div>
                </div>
                
                <!-- attachments -->
                <h4>Attachments</h4>
                <div class="attachments-div">

                    <div class="attachment row"><div class="col-md-11">
                        <div class="figure">Fig 1</div>
                        <div class="form-control">
                            <input type="file" name="attachment1" id="attachment1" onchange="checkfile(this);">
                        </div>
                        <div class="helpText">JPG, PDF, PNG, TIFF file types; max file size 2MB; minimum width 770px
                                              <br/>Be sure to explicitly cite this figure's name in relevant text above</div>

                        <label for="attachment1_title">Title</label>
                        <input id="attachment1_title" name="attachment1_title" class="form-control attachment1_title">

                        <label for="attachment1_description">Description</label>
                        <textarea id="attachment1_description" name="attachment1_description"
                                  rows="4" cols="73" class="form-control attachment1_description editor"></textarea>
                    </div><div class="col-md-1"></div></div>

                </div>

                <a class="add_att_button" href="#"><i class="fa fa-plus"></i> <span class="add_att_button_text">Add another attachment</a></a>
                <!-- sharing -->
                <h4>Sharing</h4>
                {% for field in form %}
                    <div class="fieldWrapper">
                        {{ field.errors }}
                        {% if field.auto_id != 'id_approval' %}
                        <label for="{{ field.id_for_label }}">
                            {{ field.label }}{% if field.field.required %} <span class="required">*</span>{% endif %}
                        </label>
                        {% endif %}
                        {{ field }}
                        {% if field.help_text %}
                        <p class="helptext">{{ field.help_text|safe }}</p>
                        {% endif %}
                    </div>
                {% endfor %}

                <div class="submit-button">
                    <input id="submit-button" class="btn btn-primary" type="submit" value="Submit" />
                    <a href="{{ request.META.HTTP_REFERER }}" class="btn btn-default">Cancel</a>
                </div>

   </form>

          </div>
      </div>
</div>
</div>
{% endblock content %}
